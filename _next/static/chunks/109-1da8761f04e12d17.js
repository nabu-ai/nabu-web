"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[109],{4135:function(e,t,n){let a,i;n.r(t),n.d(t,{generateTranslationAudio:function(){return Y},pauseMicrophoneRecording:function(){return en},prepareStreaming:function(){return et},processMicrophone:function(){return q},resumeMicrophoneRecording:function(){return ea},stopMicrophoneRecording:function(){return ee},supportedLanguages:function(){return X},translate:function(){return $},version:function(){return Q}});let r={"en-AU":"English (Australian)","en-GB":"English (British)","en-NZ":"English (New Zealand)","en-US":"English (US)","fr-FR":"French","fr-CA":"French (Canadian)","de-DE":"German","it-IT":"Italian","ja-JP":"Japanese","ko-KR":"Korean","pt-BR":"Portuguese (Brazilian)","es-ES":"Spanish (European)","es-US":"Spanish (US)"},s={...r,arb:"Arabic","ar-AE":"Arabic (Gulf)","ca-ES":"Catalan","yue-CN":"Chinese (Cantonese)","cmn-CN":"Chinese (Mandarin)","cs-CZ":"Czech","da-DK":"Danish","nl-BE":"Dutch (Belgian)","nl-NL":"Dutch","en-AU":"English (Australian)","en-GB":"English (British)","en-IN":"English (Indian)","en-NZ":"English (New Zealand)","en-SG":"English (Singaporean)","en-ZA":"English (South African)","en-US":"English (US)","en-GB-WLS":"English (Welsh)","fi-FI":"Finnish","fr-FR":"French","fr-BE":"French (Belgian)","fr-CA":"French (Canadian)","hi-IN":"Hindi","de-DE":"German","de-AT":"German (Austrian)","de-CH":"German (Swiss standard)","is-IS":"Icelandic","it-IT":"Italian","ja-JP":"Japanese","ko-KR":"Korean","nb-NO":"Norwegian","pl-PL":"Polish","pt-BR":"Portuguese (Brazilian)","pt-PT":"Portuguese (European)","ro-RO":"Romanian","ru-RU":"Russian","es-ES":"Spanish (Spain)","es-MX":"Spanish (Mexican)","es-US":"Spanish (US)","sv-SE":"Swedish","tr-TR":"Turkish","cy-GB":"Welsh"};class o{on(e,t){this.listeners[e]=this.listeners[e]||[],this.listeners[e].push(t)}emit(e,t){if(this.listeners[e])for(let n of this.listeners[e])n(t)}async start(e){let{onTranscription:t,onError:n,onComplete:a}=e,i=this.buildWebSocketUrl(this.token);this.ws=new WebSocket(i),this.ws.onopen=()=>{console.log("[StreamingV1] connected"),this.sendStartMessage(),this.startMic()},this.ws.onmessage=e=>{let n=JSON.parse(e.data);if(n.results&&n.results.length>0&&n.results[0].final){let e=n.results[0].alternatives[0];t({transcript:e.transcript,timestamps:e.timestamps,confidence:e.confidence,labels:n.speaker_labels})}},this.ws.onerror=e=>{n(e),console.error("[StreamingV1] error:",e)},this.ws.onclose=()=>{a(),console.log("[StreamingV1] closed")}}async stop(e){let{onStreamingStopped:t}=e;this.mediaRecorder&&"inactive"!==this.mediaRecorder.state&&this.mediaRecorder.stop(),this.ws&&this.ws.readyState===WebSocket.OPEN&&(this.ws.send(JSON.stringify({action:"stop"})),this.ws.close()),this.stream&&this.stream.getTracks().forEach(e=>e.stop()),t&&t()}async fetchToken(){let e=await fetch(this.tokenUrl);if(!e.ok)throw Error("Failed to get token");return(await e.json()).access_token}buildWebSocketUrl(e){let t=new URLSearchParams({access_token:e,model:this.model});return"".concat("https://api.us-east.speech-to-text.watson.cloud.ibm.com/v1/recognize","?").concat(t.toString())}sendStartMessage(){this.ws.send(JSON.stringify({action:"start","content-type":"audio/webm;codecs=opus",interim_results:!0,timestamps:!0,speaker_labels:!0}))}async startMic(){this.stream=await navigator.mediaDevices.getUserMedia({audio:{echoCancellation:!0,noiseSuppression:!0,autoGainControl:!0}}),this.mediaRecorder=new MediaRecorder(this.stream,{mimeType:"audio/webm;codecs=opus",audioBitsPerSecond:16e3}),this.mediaRecorder.ondataavailable=e=>{e.data.size>0&&this.ws.readyState===WebSocket.OPEN&&this.ws.send(e.data)},this.mediaRecorder.onstop=()=>{console.log("[StreamingV1] Recording stopped")},this.mediaRecorder.start(250)}constructor({token:e,model:t="en-US_BroadbandModel"}){this.token=e,this.model=t,this.ws=null,this.mediaRecorder=null,this.stream=null,this.listeners={},this.audioChunks=[]}}var l=n(4223),c=n(5796),d=n(3856),u=n.n(d);class g{async start(e,t){let{onData:n,onError:a,onComplete:i}=t;if(window&&(this.audioContext=new(window.AudioContext||window.webkitAudioContext)),e){let t=await e.arrayBuffer();this.bufferStream=t;let n=await this.audioContext.decodeAudioData(t);console.log("Duration::::",n.duration),this.bufferSource=this.audioContext.createBufferSource(),this.bufferSource.buffer=n}else this.audioStreams=await navigator.mediaDevices.getUserMedia({audio:!0}),this.audioSource=this.audioContext.createMediaStreamSource(this.audioStreams);let r={numberOfChannels:1,sampleRate:this.audioContext.sampleRate,maxFrameCount:1*this.audioContext.sampleRate/10};try{await this.audioContext.audioWorklet.addModule("./recording-processor.js"),console.log("connected")}catch(e){console.log("Add module error ".concat(e))}if(this.workletNode=new AudioWorkletNode(this.audioContext,"recording-processor",{processorOptions:r}),this.workletNode.port.postMessage({message:"UPDATE_RECORDING_STATE",setRecording:!0}),e)this.bufferSource.connect(this.workletNode).connect(this.audioContext.destination),this.bufferSource.start(),console.log("starting file");else{let e=this.audioContext.createMediaStreamDestination();this.audioSource.connect(this.workletNode).connect(e)}this.workletNode.port.onmessageerror=e=>{console.log("Error receiving message from worklet ".concat(e)),a&&a(e)};let s=u().iterator(this.workletNode.port,"message"),o=async function*(){for await(let e of s)if("SHARE_RECORDING_BUFFER"===e.data.message){let t=c(e.data.buffer[0]),n=new Uint8Array(t);yield{AudioEvent:{AudioChunk:n}}}},c=e=>{let t=new ArrayBuffer(2*e.length),n=new DataView(t);for(let t=0;t<e.length;t++){let a=Math.max(-1,Math.min(1,e[t]));n.setInt16(2*t,a<0?32768*a:32767*a,!0)}return t};this.command=new l.W({LanguageCode:this.languageCode,MediaEncoding:"pcm",MediaSampleRateHertz:"48000",AudioStream:o()});try{let e=await this.streamingClient.send(this.command);if(e.TranscriptResultStream){for await(let t of e.TranscriptResultStream){var d,g,m;if(null==t?void 0:null===(d=t.TranscriptEvent)||void 0===d?void 0:d.Transcript){for(let e of(null==t?void 0:null===(g=t.TranscriptEvent)||void 0===g?void 0:g.Transcript.Results)||[])if((null==e?void 0:e.Alternatives)&&(null==e?void 0:e.Alternatives[0].Items)){let t="";for(let n=0;n<(null==e?void 0:null===(m=e.Alternatives[0].Items)||void 0===m?void 0:m.length);n++)t+=" ".concat(null==e?void 0:e.Alternatives[0].Items[n].Content);!e.IsPartial&&(t.endsWith(" .")&&(t=t.replace(" .",".")),t&&n&&n(t))}}}i&&i()}}catch(e){a&&a(e)}}async stop(e){let{onStreamingStopped:t}=e;if(this.workletNode&&this.workletNode.port.postMessage({message:"UPDATE_RECORDING_STATE",setRecording:!1}),this.audioSource&&this.audioSource.disconnect(this.workletNode),this.bufferSource&&this.bufferSource.disconnect(this.workletNode),this.workletNode&&this.workletNode.disconnect(),this.streamingClient.destroy(),this.audioStreams){var n;null===(n=this.audioStreams.getTracks())||void 0===n||n.forEach(e=>e.stop()),this.audioStreams=null}this.audioContext&&(await this.audioContext.close(),this.audioContext=null),t&&t()}constructor({region:e,credentials:t,languageCode:n="en-US",sampleRate:a=44100}){this.region=e,this.credentials=t,this.languageCode=n,this.sampleRate=a,this.audioContext=null,this.workletNode=null,this.streamingClient=new c.I({region:e,credentials:t}),this.controller=null,this.audioStreams=null,this.bufferStream=null,this.audioSource=null,this.bufferSource=null}}var m=n(7563),f=n.n(m);let h=async e=>{try{return(await f().get("https://nabu-0390bfe7dc2f.herokuapp.com/get-token?serviceName=".concat(e))).data.access_token}catch(e){return console.error("Error fetching access token:",e),null}},p=async()=>{try{return(await f().get("https://nabu-0390bfe7dc2f.herokuapp.com/get-token?serviceName=".concat(serviceName))).data}catch(e){return console.error("Error fetching access token:",e),null}};var S=n(7272),w=n(4563);class v{async translateText(e,t,n){try{let a=new S.r({Text:e,SourceLanguageCode:t,TargetLanguageCode:n});return{translation:(await this.translateClient.send(a)).TranslatedText}}catch(e){return{translationError:e}}}constructor({region:e,credentials:t}){this.region=e,this.credentials=t,this.translateClient=new w.O({region:e,credentials:t})}}var y=n(2781),I=n.n(y);class E{async generateSpeech(e){let t=this.getIBMVoiceFromLanguageCode(e.languageCode,e.gender);if(e.voice=t,e.accessToken||(e.accessToken=this.ttsAccessToken),e.autoPlay=!1,!e.text)return{message:"Please input the 'text' param"};if(!e.accessToken)return{message:"Please input 'accessToken' param"};if(!t)return{message:"No voice found for the language code: ".concat(e.languageCode)};try{var n=e.url||"https://api.au-syd.text-to-speech.watson.cloud.ibm.com",a=this.processUserParams(e,["voice","X-Watson-Learning-Opt-Out","text","watson-token","access_token","accept","customization_id"]);let t=await fetch(n+"/v1/synthesize?"+this.stringify(a),{method:"GET"}),i=await t.blob();if(i)return{audio:i};return{message:"Failed to generate audio"}}catch(e){return{message:e}}}processUserParams(e,t){var n={};return t.forEach(t=>{var a=I()(t);void 0!==e[a]&&(n[t]=e[a])}),n}stringify(e){return Object.keys(e).map(function(t){return t+"="+encodeURIComponent(e[t])}).join("&")}getModelFromLanguageCode(e){return({"de-DE":"de-DE_Multimedia","en-US":"en-US_Multimedia","en-GB":"en-GB_Multimedia","en-AU":"en-AU_Multimedia","es-ES":"es-ES_Multimedia","fr-CA":"fr-CA_Multimedia","fr-FR":"fr-FR_Multimedia","it-IT":"it-IT_Multimedia","ja-JP":"ja-JP_Multimedia","ko-KR":"ko-KR_Multimedia","nl-NL":"nl-NL_Multimedia","pt-BR":"pt-BR_Multimedia"})[e]}getIBMVoiceFromLanguageCode(e,t){let n={"en-US":{male:"en-US_HenryV3Voice",female:"en-US_AllisonV3Voice"},"en-GB":{male:"en-GB_JamesV3Voice",female:"en-GB_KateV3Voice"},"en-AU":{male:"en-AU_JackExpressive",female:"en-AU_HeidiExpressive"},"es-ES":{male:"es-ES_EnriqueV3Voice",female:"es-ES_LauraV3Voice"},"es-LA":{female:"es-LA_SofiaV3Voice"},"es-US":{female:"es-US_SofiaV3Voice"},"fr-FR":{male:"fr-FR_NicolasV3Voice",female:"fr-FR_ReneeV3Voice"},"fr-CA":{female:"fr-CA_LouiseV3Voice"},"de-DE":{male:"de-DE_DieterV3Voice",female:"de-DE_BirgitV3Voice"},"it-IT":{female:"it-IT_FrancescaV3Voice"},"pt-BR":{male:"pt-BR_LucasExpressive",female:"pt-BR_IsabelaV3Voice"},"ja-JP":{female:"ja-JP_EmiV3Voice"},"ko-KR":{female:"ko-KR_JinV3Voice"}}[e];return n?t?n[t.toLowerCase()]||n.male||n.female||null:n:null}constructor({sttAccessToken:e,ttsAccessToken:t,languageCode:n="en-US"}){return this.sttAccessToken=e,this.ttsAccessToken=t,this.languageCode=n,this.audioStream=null,E.instance||(E.instance=this),E.instance}}var C=n(1806),k=n(1843);class A{async audioText(e,t,n,a){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"mp3",r=new C.Q({OutputFormat:i,Text:e,VoiceId:t,Engine:n,LanguageCode:a}),{AudioStream:s}=await this.pollyClient.send(r);return s}async fetchLanguages(){return{"fr-BE":{female:{voiceId:"Isabelle",engine:"neural"}},"en-US":{female:{voiceId:"Danielle",engine:"neural"},male:{voiceId:"Gregory",engine:"neural"}},"tr-TR":{female:{voiceId:"Burcu",engine:"neural"}},"cs-CZ":{female:{voiceId:"Jitka",engine:"neural"}},"de-CH":{female:{voiceId:"Sabrina",engine:"neural"}},"es-ES":{female:{voiceId:"Lucia",engine:"neural"},male:{voiceId:"Sergio",engine:"neural"}},"es-US":{female:{voiceId:"Lupe",engine:"neural"},male:{voiceId:"Pedro",engine:"neural"}},"en-SG":{female:{voiceId:"Jasmine",engine:"neural"}},"ko-KR":{female:{voiceId:"Jihye",engine:"neural"}},"sv-SE":{female:{voiceId:"Elin",engine:"neural"}},"ru-RU":{female:{voiceId:"Tatyana",engine:"standard"},male:{voiceId:"Maxim",engine:"standard"}},"ro-RO":{female:{voiceId:"Carmen",engine:"standard"}},"pt-PT":{female:{voiceId:"Ines",engine:"neural"},male:{voiceId:"Cristiano",engine:"standard"}},"pt-BR":{female:{voiceId:"Vitoria",engine:"neural"},male:{voiceId:"Thiago",engine:"neural"}},"pl-PL":{female:{voiceId:"Ola",engine:"neural"},male:{voiceId:"Jan",engine:"standard"}},"nl-BE":{female:{voiceId:"Lisa",engine:"neural"}},"nl-NL":{male:{voiceId:"Ruben",engine:"standard"},female:{voiceId:"Laura",engine:"neural"}},"nb-NO":{female:{voiceId:"Ida",engine:"neural"}},"ja-JP":{female:{voiceId:"Kazuha",engine:"neural"},male:{voiceId:"Takumi",engine:"neural"}},"it-IT":{female:{voiceId:"Bianca",engine:"neural"},male:{voiceId:"Adriano",engine:"neural"}},"is-IS":{male:{voiceId:"Karl",engine:"standard"},female:{voiceId:"Dora",engine:"standard"}},"fr-FR":{male:{voiceId:"Remi",engine:"neural"},female:{voiceId:"Lea",engine:"neural"}},"fr-CA":{female:{voiceId:"Gabrielle",engine:"neural"},male:{voiceId:"Liam",engine:"neural"}},"es-MX":{female:{voiceId:"Mia",engine:"neural"},male:{voiceId:"Andres",engine:"neural"}},"en-GB-WLS":{male:{voiceId:"Geraint",engine:"standard"}},"en-NZ":{female:{voiceId:"Aria",engine:"neural"}},"en-ZA":{female:{voiceId:"Ayanda",engine:"neural"}},"en-IN":{female:{voiceId:"Kajal",engine:"neural"}},"hi-IN":{female:{voiceId:"Kajal",engine:"neural"}},"en-GB":{female:{voiceId:"Emma",engine:"neural"},male:{voiceId:"Brian",engine:"neural"}},"en-AU":{male:{voiceId:"Russell",engine:"standard"},female:{voiceId:"Olivia",engine:"neural"}},"de-DE":{female:{voiceId:"Vicki",engine:"neural"},male:{voiceId:"Daniel",engine:"neural"}},"da-DK":{female:{voiceId:"Sofie",engine:"neural"},male:{voiceId:"Mads",engine:"standard"}},"cy-GB":{female:{voiceId:"Gwyneth",engine:"standard"}},"cmn-CN":{female:{voiceId:"Zhiyu",engine:"neural"}},arb:{female:{voiceId:"Hala",engine:"neural"},male:{voiceId:"Zayd",engine:"neural"}},"ar-AE":{female:{voiceId:"Hala",engine:"neural"},male:{voiceId:"Zayd",engine:"neural"}},"ca-ES":{female:{voiceId:"Arlet",engine:"neural"}},"de-AT":{female:{voiceId:"Hannah",engine:"neural"}},"yue-CN":{female:{voiceId:"Hiujin",engine:"neural"}},"fi-FI":{female:{voiceId:"Suvi",engine:"neural"}},"en-IE":{female:{voiceId:"Niamh",engine:"neural"}}}}formatVoices(e){let t={},n={neural:3,standard:2,generative:1};function a(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return n[e.toLowerCase()]||0}function i(e,n){t[e]||(t[e]={});let i=n.Gender.toLowerCase(),r=n.Id||n.VoiceId,s=n.SupportedEngines||(n.Engine?[n.Engine]:[]),o=s.includes("neural")?"neural":s.includes("standard")?"standard":s[0]||"",l=a(o);if("female"===i){let n=t[e].female,i=a(null==n?void 0:n.engine);(!n||l>i)&&(t[e].female={voiceId:r,engine:o})}if("male"===i){let n=t[e].male,i=a(null==n?void 0:n.engine);(!n||l>i)&&(t[e].male={voiceId:r,engine:o})}}for(let[t,n]of Object.entries(e))for(let e of n)if(i(t,e),Array.isArray(e.AdditionalLanguageCodes))for(let t of e.AdditionalLanguageCodes)i(t,e);return t}async fetchVoiceAndEngine(e,t){return{voice:"",engine:""}}async getVoiceIdAndEngine(e,t){return await this.getVoices(e,t)}async getVoices(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,{male:n,female:a}=(await this.fetchLanguages())[e];return(n||a)&&t?"male"===t&&n?n:"female"===t&&a?a:"male"!==t||n?"female"!==t||a?void 0:n:a:{}}constructor({region:e,credentials:t,languageCode:n,gender:a}){return this.region=e,this.credentials=t,this.languageCode=n,this.gender=a,this.pollyClient=new k.z({region:e,credentials:t}),A.instance||(A.instance=this),A.instance}}class b{on(e,t){this.listeners[e]||(this.listeners[e]=[]),this.listeners[e].push(t)}emit(e,t){(this.listeners[e]||[]).forEach(e=>e(t))}off(e,t){this.listeners[e]&&(this.listeners[e]=this.listeners[e].filter(e=>e!==t))}constructor(){this.listeners={}}}new b;let R={},T=async()=>{let e=await p();R={region:e.region,credentials:{accessKeyId:e.apiKey,secretAccessKey:e.secretKey}};let t=await h("stt");a=new o({token:t}),await a.initializeWS(t)},N=async e=>{let{sourceLanguage:t,targetLanguage:n,audioHeardAs:a,output:i,onProcessed:r,onError:s}=e;return await M({sourceLanguage:t,targetLanguage:n,audioHeardAs:a,output:i,onProcessed:r,onError:s})},O=async e=>{let{onStopped:t}=e;return await D({onStopped:t})},U=async e=>{let{onPaused:t}=e;return await L({onPaused:t})},V=async e=>{let{onResumed:t}=e;return await P({onResumed:t})},_=async e=>{let{text:t,sourceLanguage:n,targetLanguage:a,audioHeardAs:i,onTranslated:r,onProcessed:s,onError:o}=e;return await j({transcript:t,sourceLanguage:n,targetLanguage:a,audioHeardAs:i,onTranslated:r,onProcessed:s,onError:o})},B=async e=>{let{text:t,sourceLanguage:n,targetLanguage:a,onProcessed:i,onError:r}=e,{translation:s,translationError:o}=await J({transcript:t,sourceLanguage:n,targetLanguage:a});o?r&&r(o):i({translation:s})},M=async e=>{let{sourceLanguage:t,targetLanguage:n,audioHeardAs:a,output:i,onProcessed:s,onError:o}=e;return Object.keys(r).includes(t)?await x({sourceLanguage:t,targetLanguage:n,audioHeardAs:a,output:i,onProcessed:s,onError:o}):await W({sourceLanguage:t,targetLanguage:n,audioHeardAs:a,output:i,onProcessed:s,onError:o})},x=async e=>{let{sourceLanguage:t,targetLanguage:n,audioHeardAs:i,output:r,onProcessed:s,onError:l}=e;a||(a=new o({token:await h("stt")})),await a.start({onTranscription:async e=>{if("transcriptOnly"===r)s({transcript:e.transcript});else if("translateOnly"===r){let{translation:a,translationError:i}=await J({transcript:e.transcript,sourceLanguage:t,targetLanguage:n});i?l&&l(i):s({transcript:e.transcript,translation:a})}else"audioOnly"===r&&s(await j({transcript:e.transcript,sourceLanguage:t,targetLanguage:n,audioHeardAs:i}))},onError:e=>{l&&l("[NABU StreamingV1] error:",e)},onComplete:()=>{}})},L=async e=>{let{onPaused:t}=e;if(a&&a instanceof o)return await a.pause({onPaused:t})},P=async e=>{let{onResumed:t}=e;if(a&&a instanceof o)return await a.resume({onResumed:t})},D=async e=>{let{onStopped:t}=e;return a&&a instanceof o?await G({onStopped:t}):i&&i instanceof g?await F({onStopped:t}):void 0},G=async e=>{let{onStopped:t}=e;a&&a instanceof o&&await a.stop({onStreamingStopped:()=>{t()}})},F=async e=>{let{onStopped:t}=e;i&&i instanceof g&&await i.stop({onStreamingStopped:()=>{i=null,t()}})},W=async e=>{let{sourceLanguage:t,targetLanguage:n,audioHeardAs:a,output:r,onProcessed:s,onError:o}=e;i=new g({region:R.region,credentials:R.credentials,languageCode:t}),await i.start(null,{onData:async e=>{if("transcriptOnly"===r)s({transcript:e});else if("translateOnly"===r){let{translation:a,translationError:i}=await J({transcript:data.transcript,sourceLanguage:t,targetLanguage:n});i?o&&o(i):s({transcript:e,translation:a})}else"audioOnly"===r&&s(await j({transcript:e,sourceLanguage:t,targetLanguage:n,audioHeardAs:a}))},onError:e=>{o&&o("[NABU StreamingV1] error:",e)},onComplete:()=>{}})},J=async e=>{let{transcript:t,sourceLanguage:n,targetLanguage:a}=e;console.log("getTranslationText: ".concat(t));let i=new v({region:R.region,credentials:R.credentials}),{translation:r,translationError:s}=await i.translateText(t,n,a);return{translation:r,translationError:s}},j=async e=>{let{transcript:t,sourceLanguage:n,targetLanguage:a,audioHeardAs:i,onTranslated:s,onProcessed:o,onError:l}=e;return(console.log("Generating translation for text: ".concat(t)),Object.keys(r).includes(a))?await H({transcript:t,sourceLanguage:n,targetLanguage:a,audioHeardAs:i,onTranslated:s,onProcessed:o,onError:l}):await K({transcript:t,sourceLanguage:n,targetLanguage:a,audioHeardAs:i,onTranslated:s,onProcessed:o,onError:l})},H=async e=>{let{transcript:t,sourceLanguage:n,targetLanguage:a,audioHeardAs:i,onTranslated:r,onProcessed:s,onError:o}=e,{translation:l,translationError:c}=await J({transcript:t,sourceLanguage:n,targetLanguage:a});c&&o&&o({message:c}),r&&r({translation:l,translationError:c});let{audio:d,message:u}=await z({text:l,targetLanguage:a,audioHeardAs:i});s&&d&&s({translation:l,audio:d,message:u})},K=async e=>{let{transcript:t,sourceLanguage:n,targetLanguage:a,audioHeardAs:i,onTranslated:r,onProcessed:s,onError:o}=e,{translation:l,translationError:c}=await J({transcript:t,sourceLanguage:n,targetLanguage:a});c&&o&&o({message:c}),r&&r({translation:l,translationError:c});let d=await Z({text:l,targetLanguage:a,audioHeardAs:i});s&&d&&s({translation:l,audio:d})},Z=async e=>{let{text:t,targetLanguage:n,audioHeardAs:a}=e,i=new A({region:R.region,credentials:R.credentials,languageCode:n,gender:a}),{voiceId:r,engine:s}=await i.getVoiceIdAndEngine(n,a),o=await i.audioText(t,r,s,n,"mp3");return new Blob([await o.transformToByteArray()],{type:"audio/mpeg"})},z=async e=>{let{text:t,targetLanguage:n,audioHeardAs:a}=e,i=await h("tts"),r=new E({sttAccessToken:i,languageCode:n}),{audio:s,message:o}=await r.generateSpeech({gender:a,languageCode:n,accessToken:i,text:t});return{audio:s,message:o}},Q=n(9079).env.npm_package_version,X=s,q=async e=>{let{sourceLanguage:t,targetLanguage:n,audioHeardAs:a,output:i,onProcessed:r,onError:s}=e;return await N({sourceLanguage:t,targetLanguage:n,audioHeardAs:a,output:i,onProcessed:r,onError:s})},$=async e=>{let{text:t,sourceLanguage:n,targetLanguage:a,onProcessed:i,onError:r}=e;return await B({text:t,sourceLanguage:n,targetLanguage:a,onProcessed:i,onError:r})},Y=async e=>{let{text:t,sourceLanguage:n,targetLanguage:a,audioHeardAs:i,onTranslated:r,onProcessed:s,onError:o}=e;return await _({text:t,sourceLanguage:n,targetLanguage:a,audioHeardAs:i,onTranslated:r,onProcessed:s,onError:o})},ee=async e=>{let{onStopped:t}=e;return await O({onStopped:t})},et=async()=>await T(),en=async e=>{let{onPaused:t}=e;return await U({onPaused:t})},ea=async e=>{let{onResumed:t}=e;return await V({onResumed:t})}},4289:function(e,t,n){n.d(t,{Ie:function(){return p},SQ:function(){return d},SS:function(){return h},aT:function(){return m},bE:function(){return u},e$:function(){return f},vP:function(){return g},wQ:function(){return S},yt:function(){return c}});var a=n(4095);let i=null,r=new Set,s=new Set,o=new Set,l=new Set;function c(e,t){return i||((i=new WebSocket("ws://nabu-0390bfe7dc2f.herokuapp.com?room=".concat(e,"&uid=").concat(t))).onopen=()=>{console.log("[NABU WS] Connected to room ".concat(e))},i.onerror=e=>{console.error("[NABU WS] WebSocket error",e)},i.onclose=()=>{console.warn("[NABU WS] Disconnected"),i=null},i.onmessage=e=>{try{let t=JSON.parse(e.data);if("hand"===t.type)r.forEach(e=>e(t.uid,t.raised));else if("chat"===t.type)s.forEach(e=>e(t.uid,t.text));else if("mute"===t.type)o.forEach(e=>e(t.uid,t.muted));else if("transcript"===t.type)a.E.getState().setActiveSpeaker(t.uid),l.forEach(e=>e(t.uid,t.transcript,t.sourceLanguage,t.audioHeardAs));else if("room-state"===t.type){let{raisedHands:e,mutedUsers:n}=t,i=a.E.getState();Object.entries(e||{}).forEach(e=>{let[t,n]=e;i.setHandState(t,n)}),Object.entries(n||{}).forEach(e=>{let[t,n]=e;i.setMuteState(t,n)})}}catch(t){console.warn("[NABU WS] Invalid message",e.data)}}),i}function d(e,t){i&&i.readyState===WebSocket.OPEN&&i.send(JSON.stringify({type:"hand",uid:e,raised:t}))}function u(e,t){i&&i.readyState===WebSocket.OPEN&&i.send(JSON.stringify({type:"chat",uid:e,text:t}))}function g(e,t){i&&i.readyState===WebSocket.OPEN&&i.send(JSON.stringify({type:"mute",uid:e,muted:t}))}function m(e,t,n,a){i&&i.readyState===WebSocket.OPEN&&i.send(JSON.stringify({type:"transcript",uid:e,transcript:t,sourceLanguage:n,audioHeardAs:a}))}function f(e){return r.add(e),()=>{r.delete(e)}}function h(e){return s.add(e),()=>{s.delete(e)}}function p(e){return o.add(e),()=>{o.delete(e)}}function S(e){return l.add(e),()=>{l.delete(e)}}},4095:function(e,t,n){n.d(t,{E:function(){return a}});let a=(0,n(2574).U)(e=>({muted:!0,videoEnabled:!1,raisedHands:{},mutedUsers:{},activeSpeakerUid:null,toggleMute:()=>e(e=>({muted:!e.muted})),toggleVideo:()=>e(e=>({videoEnabled:!e.videoEnabled})),raiseHand:t=>e(e=>{var n;let a=null!==(n=e.raisedHands[t])&&void 0!==n&&n;return{raisedHands:{...e.raisedHands,[t]:!a}}}),muteUser:t=>e(e=>{var n;let a=null!==(n=e.mutedUsers[t])&&void 0!==n&&n;return{mutedUsers:{...e.mutedUsers,[t]:!a}}}),setActiveSpeaker:t=>e(()=>({activeSpeakerUid:t})),agoraInstance:null,agoraClient:null,setAgoraInstance:t=>e(()=>({agoraInstance:t})),setAgoraClient:t=>e(()=>({agoraInstance:t})),isChatOpen:!1,isTranscriptOpen:!1,isParticipantsOpen:!1,toggleChat:()=>e(e=>({isChatOpen:!e.isChatOpen,isParticipantsOpen:!1,isTranscriptOpen:!1})),toggleTranscript:()=>e(e=>({isTranscriptOpen:!e.isTranscriptOpen,isParticipantsOpen:!1,isChatOpen:!1})),toggleParticipants:()=>e(e=>({isParticipantsOpen:!e.isParticipantsOpen,isChatOpen:!1,isTranscriptOpen:!1})),messages:[],addMessage:(t,n)=>e(e=>({messages:[...e.messages,{uid:t,text:n,time:new Date().toLocaleTimeString()}]})),transcripts:[],addTranscript:(t,n,a,i)=>e(e=>({transcripts:[...e.transcripts,{uid:t,transcript:n,sourceLanguage:a,audioHeardAs:i,time:new Date().toLocaleTimeString()}]})),meetingInfo:{},setMeetingInfo:t=>e(()=>({meetingInfo:t})),setHandState:(t,n)=>e(e=>({raisedHands:n?{...e.raisedHands,[t]:!0}:Object.fromEntries(Object.entries(e.raisedHands).filter(e=>{let[n]=e;return n!==t}))})),setMuteState:(t,n)=>e(e=>({mutedUsers:n?{...e.mutedUsers,[t]:!0}:Object.fromEntries(Object.entries(e.mutedUsers).filter(e=>{let[n]=e;return n!==t}))}))}))}}]);