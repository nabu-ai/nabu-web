(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[918],{4303:function(e,t,a){Promise.resolve().then(a.bind(a,1367))},1367:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return L}});var s=a(3827),r=a(4090),l=a(4095);function n(e,t,a,s,n){const i=(0,l.E)((e=>e.agoraInstance));let o=(0,l.E)((e=>e.agoraClient));const c=(0,r.useRef)(null),[d,u]=(0,r.useState)([]),[x,h]=(0,r.useState)([]),g=(0,r.useRef)(!1),p=()=>{h([...o.remoteUsers])};(0,r.useEffect)((()=>{(async()=>{if(!g.current)try{await o.join(e,a,t,s),g.current=!0;const r=await i.createCameraVideoTrack();r.setEnabled(n),c.current=r,u([null,r]),await o.publish([r]);for(const e of o.remoteUsers)e.hasVideo&&await o.subscribe(e,"video").catch((()=>{}));p(),o.on("user-joined",p),o.on("user-published",(async(e,t)=>{await o.subscribe(e,t).catch((()=>{})),p()})),o.on("user-unpublished",p),o.on("user-left",p),o.on("user-updated",p)}catch(r){console.error("[Agora Error] Failed to start video-only session:",r),g.current=!1}})();return()=>{var e,t;null===(e=c.current)||void 0===e||e.stop(),null===(t=c.current)||void 0===t||t.close(),null===o||void 0===o||o.leave().catch((()=>{})),g.current=!1}}),[]);const m=(0,l.E)((e=>e.videoEnabled));return(0,r.useEffect)((()=>{var e,t;null===(t=c.current)||void 0===t||null===(e=t.setEnabled)||void 0===e||e.call(t,m)}),[m]),{localTracks:d,remoteUsers:x}}function i(e){let{user:t,isLocal:a}=e;var n,i;const o=(0,r.useRef)(null),{raisedHands:c,mutedUsers:d,activeSpeakerUid:u,videoEnabled:x}=(0,l.E)(),h=c[t.uid],g=u===t.uid,p=d[t.uid],m=a?x:t.hasVideo,v=!t.videoTrack||!m;(0,r.useEffect)((()=>{const e=o.current;if(!v&&e&&(null===t||void 0===t?void 0:t.videoTrack)&&"function"===typeof t.videoTrack.play){e.innerHTML="";try{t.videoTrack.play(e)}catch(a){console.warn("Video play error for ".concat(t.uid,":"),a)}}else e&&(e.innerHTML="");return()=>{(null===t||void 0===t?void 0:t.videoTrack)&&"function"===typeof t.videoTrack.stop&&t.videoTrack.stop(),e&&(e.innerHTML="")}}),[t.videoTrack,t.uid,m]);const f=((null===t||void 0===t||null===(i=t.uid)||void 0===i||null===(n=i.toString)||void 0===n?void 0:n.call(i).charAt(0))||"?").toUpperCase();return(0,s.jsxs)("div",{className:"relative aspect-video rounded-xl overflow-hidden bg-black shadow ".concat(g?"ring-4 ring-blue-400":""),children:[m?(0,s.jsx)("div",{ref:o,className:"w-full h-full"}):(0,s.jsx)("span",{className:"w-full h-full flex items-center justify-center text-white text-2xl bg-gray-800",children:f}),p&&(0,s.jsx)("div",{className:"absolute top-2 right-2 bg-black bg-opacity-60 p-1 rounded-full",children:"\ud83d\udeab\ud83c\udfa4"}),(0,s.jsxs)("div",{className:"absolute bottom-2 left-2 text-xs bg-black bg-opacity-60 text-white px-2 py-1 rounded",children:["".concat(t.uid)," ",h&&"\u270b"]})]})}var o=a(7977);const c=(0,o.Z)("mic-off",[["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}],["path",{d:"M18.89 13.23A7.12 7.12 0 0 0 19 12v-2",key:"80xlxr"}],["path",{d:"M5 10v2a7 7 0 0 0 12 5",key:"p2k8kg"}],["path",{d:"M15 9.34V5a3 3 0 0 0-5.68-1.33",key:"1gzdoj"}],["path",{d:"M9 9v3a3 3 0 0 0 5.12 2.12",key:"r2i35w"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22",key:"x3vr5v"}]]),d=(0,o.Z)("mic",[["path",{d:"M12 2a3 3 0 0 0-3 3v7a3 3 0 0 0 6 0V5a3 3 0 0 0-3-3Z",key:"131961"}],["path",{d:"M19 10v2a7 7 0 0 1-14 0v-2",key:"1vc78b"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22",key:"x3vr5v"}]]),u=(0,o.Z)("video",[["path",{d:"m16 13 5.223 3.482a.5.5 0 0 0 .777-.416V7.87a.5.5 0 0 0-.752-.432L16 10.5",key:"ftymec"}],["rect",{x:"2",y:"6",width:"14",height:"12",rx:"2",key:"158x01"}]]),x=(0,o.Z)("video-off",[["path",{d:"M10.66 6H14a2 2 0 0 1 2 2v2.5l5.248-3.062A.5.5 0 0 1 22 7.87v8.196",key:"w8jjjt"}],["path",{d:"M16 16a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h2",key:"1xawa7"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]),h=(0,o.Z)("hand",[["path",{d:"M18 11V6a2 2 0 0 0-2-2a2 2 0 0 0-2 2",key:"1fvzgz"}],["path",{d:"M14 10V4a2 2 0 0 0-2-2a2 2 0 0 0-2 2v2",key:"1kc0my"}],["path",{d:"M10 10.5V6a2 2 0 0 0-2-2a2 2 0 0 0-2 2v8",key:"10h0bg"}],["path",{d:"M18 8a2 2 0 1 1 4 0v6a8 8 0 0 1-8 8h-2c-2.8 0-4.5-.86-5.99-2.34l-3.6-3.6a2 2 0 0 1 2.83-2.82L7 15",key:"1s1gnw"}]]),g=(0,o.Z)("phone-off",[["path",{d:"M10.1 13.9a14 14 0 0 0 3.732 2.668 1 1 0 0 0 1.213-.303l.355-.465A2 2 0 0 1 17 15h3a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2 18 18 0 0 1-12.728-5.272",key:"1wngk7"}],["path",{d:"M22 2 2 22",key:"y4kqgn"}],["path",{d:"M4.76 13.582A18 18 0 0 1 2 4a2 2 0 0 1 2-2h3a2 2 0 0 1 2 2v3a2 2 0 0 1-.8 1.6l-.468.351a1 1 0 0 0-.292 1.233 14 14 0 0 0 .244.473",key:"10hv5p"}]]),p=(0,o.Z)("message-circle-more",[["path",{d:"M7.9 20A9 9 0 1 0 4 16.1L2 22Z",key:"vv11sd"}],["path",{d:"M8 12h.01",key:"czm47f"}],["path",{d:"M12 12h.01",key:"1mp3jc"}],["path",{d:"M16 12h.01",key:"1l6xoz"}]]),m=(0,o.Z)("message-square-text",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}],["path",{d:"M13 8H7",key:"14i4kc"}],["path",{d:"M17 12H7",key:"16if0g"}]]),v=(0,o.Z)("users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]]);var f=a(4289);const y=a(4135),{processMicrophone:b,stopMicrophoneRecording:j}=y;function k(e){let{uid:t,roomName:a}=e;const{raiseHand:n,muteUser:i}=(0,l.E)(),o=(0,l.E)((e=>e.meetingInfo)),y=(0,l.E)((e=>e.raisedHands[t])),k=(0,l.E)((e=>e.mutedUsers[t])),w=(0,l.E)((e=>e.muted)),N=((0,l.E)((e=>e.toggleMute)),(0,l.E)((e=>e.videoEnabled))),E=(0,l.E)((e=>e.toggleVideo)),M=(0,l.E)((e=>e.toggleChat)),T=(0,l.E)((e=>e.toggleTranscript)),S=(0,l.E)((e=>e.toggleParticipants)),L=(0,l.E)((e=>e.addTranscript)),C=(0,r.useRef)(!1),[H,U]=(0,r.useState)(0);(0,r.useEffect)((()=>{C.current||(C.current=!0,w&&(i(t),(0,f.vP)(t,!0)));const e=(0,f.e$)(((e,t)=>{l.E.getState().setHandState(e,t)})),a=(0,f.Ie)(((e,t)=>{l.E.getState().setMuteState(e,t)}));return()=>{e(),a()}}),[]),(0,r.useEffect)((()=>{const e=setInterval((()=>{U((e=>e+1))}),1e3);return()=>clearInterval(e)}),[]);const V=e=>{l.E.getState().setActiveSpeaker(t),console.log("Data response::",e),(null===e||void 0===e?void 0:e.transcript)&&((0,f.aT)(t,e.transcript,o.language,o.gender),L(t,e.transcript,o.language,o.gender))},A=()=>{},Z=()=>{console.log("microphone stopped")};return(0,s.jsxs)("div",{className:"fixed top-1/2 right-4 transform -translate-y-1/2 flex flex-col items-center space-y-4 z-50 text-white",children:[(0,s.jsx)("div",{className:"mb-6 text-sm font-semibold text-gray-300",children:a}),(0,s.jsx)("button",{title:k?"Unmute":"Mute",onClick:()=>{if(k){const e="transcriptOnly",t={sourceLanguage:o.language,targetLanguage:null,audioHeardAs:o.gender,output:e,onProcessed:V,onError:A};b(t)}else j({onStopped:Z});i(t),(0,f.vP)(t,!k)},className:"p-3 hover:bg-gray-600 rounded-full text-white ".concat(k?"bg-red-600":"bg-gray-700"),children:k?(0,s.jsx)(c,{}):(0,s.jsx)(d,{})}),(0,s.jsx)("button",{title:N?"Video On":"Video Off",onClick:E,className:"p-3 hover:bg-gray-600 rounded-full text-white ".concat(N?"bg-gray-700":"bg-red-600"),children:N?(0,s.jsx)(u,{}):(0,s.jsx)(x,{})}),(0,s.jsx)("button",{title:y?"Put hand down":"Raise Hand",onClick:()=>{n(t),(0,f.SQ)(t,!y)},className:"p-3 hover:bg-gray-600 rounded-full text-white ".concat(y?"bg-yellow-600":"bg-gray-700"),children:(0,s.jsx)(h,{})}),(0,s.jsx)("button",{title:"Leave",onClick:()=>{window.location.href="/nabu-web/lobby"},className:"p-3 bg-red-600 hover:bg-red-500 rounded-full text-white",children:(0,s.jsx)(g,{})}),(0,s.jsx)("div",{className:"border-t border-gray-500 w-8 my-4"}),(0,s.jsx)("button",{onClick:M,title:"Chat",className:"p-3 bg-gray-700 hover:bg-gray-600 rounded-full text-white",children:(0,s.jsx)(p,{})}),(0,s.jsx)("button",{onClick:T,title:"Transcripts",className:"p-3 bg-gray-700 hover:bg-gray-600 rounded-full text-white",children:(0,s.jsx)(m,{})}),(0,s.jsx)("button",{onClick:S,title:"Participants",className:"p-3 bg-gray-700 hover:bg-gray-600 rounded-full text-white",children:(0,s.jsx)(v,{})}),(0,s.jsx)("div",{className:"mt-auto text-sm text-gray-400 pt-6",children:(e=>{const t=Math.floor(e/60).toString().padStart(2,"0"),a=(e%60).toString().padStart(2,"0");return"".concat(t,":").concat(a)})(H)})]})}const w=(0,o.Z)("send-horizontal",[["path",{d:"M3.714 3.048a.498.498 0 0 0-.683.627l2.843 7.627a2 2 0 0 1 0 1.396l-2.842 7.627a.498.498 0 0 0 .682.627l18-8.5a.5.5 0 0 0 0-.904z",key:"117uat"}],["path",{d:"M6 12h16",key:"s4cdu5"}]]);function N(e){let{uid:t,room:a}=e;const n=(0,l.E)((e=>e.isChatOpen)),i=(0,l.E)((e=>e.messages)),o=(0,l.E)((e=>e.addMessage)),[c,d]=(0,r.useState)("");(0,r.useEffect)((()=>{const e=(0,f.SS)(((e,t)=>{l.E.getState().addMessage(e,t)}));return e}),[]);const u=()=>{c.trim()&&((0,f.bE)(t,c.trim()),o(t,c.trim()),d(""))};return n?(0,s.jsxs)("div",{className:"w-1/4 flex flex-col rounded-xl bg-white text-black shadow-lg  border-l m-4 ml-0",children:[(0,s.jsx)("div",{className:"p-4 text-lg font-bold border-b",children:"Chat Messages"}),(0,s.jsx)("div",{className:"flex-1 p-4 overflow-y-auto space-y-2",children:i.map(((e,a)=>(0,s.jsxs)("div",{className:"flex flex-col items-start",children:[(0,s.jsxs)("div",{className:"text-sm text-gray-500 flex  w-full max-w-xs gap-4",children:[(0,s.jsx)("span",{children:(0,s.jsx)("b",{children:e.uid===t?"You":e.uid})}),(0,s.jsx)("span",{children:e.time})]}),(0,s.jsx)("div",{className:"p-2 pl-0 rounded-lg text-sm",children:e.text})]},a)))}),(0,s.jsx)("div",{className:"p-4 flex",children:(0,s.jsxs)("div",{className:"flex items-center p-2 border border-gray-300 rounded-full  w-full",children:[(0,s.jsx)("input",{type:"text",value:c,onChange:e=>d(e.target.value),onKeyDown:e=>{"Enter"===e.key&&u()},className:"flex-1 p-2 outline-none bg-transparent",placeholder:"Type a message..."}),(0,s.jsx)("button",{className:"p-2 text-gray-500 hover:text-blue-500",onClick:u,children:(0,s.jsx)(w,{})})]})})]}):null}const E=(0,o.Z)("ellipsis-vertical",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]]);function M(e){let{localUid:t,localName:a,remoteUsers:r}=e;const n=(0,l.E)((e=>e.isParticipantsOpen)),i=(0,l.E)((e=>e.raisedHands)),o=(0,l.E)((e=>e.muted));if(!n)return null;const u=[{uid:t,isLocal:!0,muted:o,name:a},...r.map((e=>{var t;return{uid:e.uid,name:e.name,isLocal:!1,muted:!0!==(null===(t=e.audioTrack)||void 0===t?void 0:t.isPlaying)}}))];return(0,s.jsxs)("div",{className:"w-1/4 flex flex-col rounded-xl bg-white text-black shadow-lg  border-l m-4 ml-0",children:[(0,s.jsx)("h2",{className:"p-4 text-lg font-bold border-b",children:"Participants"}),(0,s.jsx)("div",{className:"space-y-3",children:u.map(((e,t)=>{return(0,s.jsxs)("div",{className:"flex items-center justify-between p-2 m-2 rounded-md bg-gray-100",children:[(0,s.jsx)("div",{className:"w-10 h-10 flex items-center justify-center rounded-full bg-gray-500 text-white font-bold",children:(a=e.uid,null===a||void 0===a?void 0:a.split(" ").map((e=>e[0])).join("").toUpperCase())}),(0,s.jsxs)("div",{className:"flex-1 mx-3",children:[(0,s.jsxs)("p",{className:"text-sm font-medium",children:[e.isLocal?"You":"".concat(e.uid)," ",i[e.uid]&&"\u270b"]}),(0,s.jsx)("p",{className:"text-xs text-gray-400",children:e.uid?"joined":"NA"})]}),(0,s.jsxs)("div",{className:"flex space-x-2 text-gray-400",children:[(0,s.jsx)("button",{className:"hover:text-white",children:e.muted?(0,s.jsx)(c,{}):(0,s.jsx)(d,{})}),(0,s.jsx)("button",{className:"hover:text-red-500",children:(0,s.jsx)(E,{className:"w-5 h-5"})})]})]},t);var a}))})]})}const T=a(4135);function S(e){let{uid:t}=e;const a=(0,l.E)((e=>e.isTranscriptOpen)),n=(0,l.E)((e=>e.transcripts)),i=(0,l.E)((e=>e.meetingInfo));return(0,r.useEffect)((()=>{const{generateTranslationAudio:e,translate:t}=T,a=(0,f.wQ)(((t,a,s,r)=>{const n={text:a,sourceLanguage:s,targetLanguage:i.language,audioHeardAs:r,onTranslated:e=>{const{translation:a}=e;l.E.getState().addTranscript(t,a,i.language,i.gender)},onProcessed:e=>{const{translation:t,audio:a}=e;if(a){console.log("Audio received on:::",(new Date).toLocaleTimeString());new Audio(URL.createObjectURL(a)).play()}},onError:e=>{console.log("Error:::",e)}};console.log("receiver options:::",n),e(n)}));return a}),[]),a?(0,s.jsxs)("div",{className:"w-1/4 flex flex-col rounded-xl bg-white text-black shadow-lg  border-l m-4 ml-0",children:[(0,s.jsx)("div",{className:"p-4 text-lg font-bold border-b",children:"Transcripts"}),(0,s.jsx)("div",{className:"flex-1 p-4 overflow-y-auto space-y-2",children:n.map(((e,a)=>(0,s.jsxs)("div",{className:"flex flex-col items-start",children:[(0,s.jsxs)("div",{className:"text-xs text-gray-500 flex  w-full max-w-xs gap-4",children:[(0,s.jsx)("span",{children:(0,s.jsx)("b",{children:e.uid===t?"You":e.uid})}),(0,s.jsx)("span",{children:e.time})]}),(0,s.jsx)("div",{className:"p-2 pl-0 rounded-lg text-xs",children:e.transcript})]},a)))})]}):null}function L(){const e=(0,l.E)((e=>e.meetingInfo)),t=e.name||"Guest",a=(e.language,e.room),r=t,{localTracks:o,remoteUsers:c}=n(e.appId,e.token,a,t,!1);return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"flex h-screen bg-gray-900 text-white pr-20",children:[(0,s.jsx)("div",{className:"flex-1 flex p-4 w-full bg-white rounded-xl m-4",children:(0,s.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-3 gap-4 w-full transition-all",children:[o[1]&&(0,s.jsx)(i,{user:{name:String(t),uid:String(r),audioTrack:o[0],videoTrack:o[1]},isLocal:!0}),c.map((e=>(0,s.jsx)(i,{user:{name:String(t),uid:String(e.uid),videoTrack:e.videoTrack,audioTrack:e.audioTrack,hasVideo:e.hasVideo},isLocal:!1},String(e.uid))))]})}),(0,s.jsx)(N,{uid:r,room:a}),(0,s.jsx)(S,{uid:r}),(0,s.jsx)(M,{localUid:r,localName:t,remoteUsers:c})]}),(0,s.jsx)(k,{uid:r,roomName:a})]})}}},function(e){e.O(0,[668,109,971,69,744],(function(){return t=4303,e(e.s=t);var t}));var t=e.O();_N_E=t}]);